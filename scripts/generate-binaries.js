const fs = require('fs');
const path = require('path');

const wasmPath = path.join(process.cwd(), 'node_modules/swisseph-wasm/wsam/swisseph.wasm');
const dataPath = path.join(process.cwd(), 'node_modules/swisseph-wasm/wsam/swisseph.data');
const outputPath = path.join(process.cwd(), 'src/lib/astrology/swisseph-binaries.ts');

try {
    console.log('Reading binaries...');
    const wasmBuffer = fs.readFileSync(wasmPath);
    const dataBuffer = fs.readFileSync(dataPath);

    console.log(`WASM size: ${wasmBuffer.length} bytes`);
    console.log(`DATA size: ${dataBuffer.length} bytes`);

    const content = `// Auto-generated by scripts/generate-binaries.js
// eslint-disable
// prettier-ignore

export const swissephWasm = "${wasmBuffer.toString('base64')}";
export const swissephData = "${dataBuffer.toString('base64')}";
`;

    fs.writeFileSync(outputPath, content);
    console.log(`Successfully wrote binaries to ${outputPath}`);
} catch (error) {
    console.error('Error generating binaries:', error);
    process.exit(1);
}
